#: include SecondWindow.kv
#: include SimpleWindow.kv
#: include InfoScreen.kv
#:import MDSwitch kivymd.uix.selectioncontrol.MDSwitch
#:import MDRoundFlatIconButton kivymd.uix.button.MDRoundFlatIconButton
#:import MDIconButton kivymd.uix.button.MDIconButton
#:import MDRectangleFlatIconButton kivymd.uix.button.MDRectangleFlatIconButton
#:import MDSlider kivymd.uix.slider.MDSlider
#:import MDTapTargetView kivymd.uix.taptargetview.MDTapTargetView
#:import MDLabel kivymd.uix.label.MDLabel
#:import MDToolbar kivymd.uix.toolbar.MDToolbar
#:import NavigationLayout kivymd.uix.navigationdrawer.NavigationLayout
#:import MDSeparator kivymd.uix.card.MDSeparator
#:import MDBoxLayout kivymd.uix.boxlayout.MDBoxLayout
#:import MDCheckbox kivymd.uix.selectioncontrol.MDCheckbox
#: import NoTransition kivy.uix.screenmanager.NoTransition
#: import FadeTransition kivy.uix.screenmanager.FadeTransition
#: import SlideTransition kivy.uix.screenmanager.SlideTransition




<P>:
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "120dp"






<P2>:

<P3>:

<P4>:

<Prpm>:

<Ph2t>:

<Pdiam>:

<Label>
    id: labels
    color: [0,0,0,1]

<TextInput>
    spacing: 5
    write_tab: False
    input_filter:'float'
    cursor_color: 0.2,0.5,0,0.8
    cursor_width: '2dp'
    multiline:False

<MDRectangleFlatIconButton>:
    text_color:0,0,0,1
    size_hint: 1,0.33
    md_bg_color: 1,1,1,1

# <MDTapTargetView>
#     widget:info_button
#     discription_texy:"heuyyyy"

<MDSwitch>
    size_hint:0.15,1
    _thumb_color :[0.2,.2,.2,1]

<MDSlider>
    size_hint_x: 0.7
    value_track: True
    _track_color_normal: [.4,0.4,0.4,1]
    _track_color_active:[1,1,1,1]
    thumb_color_down:[0,.6,.8,1]
    show_off:False
    hint:False

<MDCheckbox>
    size_hint_x: 0.3
    color: [0,0,0,1]
#    selected_color: [0,0,1,1]
    unselected_color: [0,0,0,1]
    group: 'st'

NavigationLayout:
    id:NL
    WindowManager:
        id: win_manager
        transition: NoTransition()
        VelocityTriangles:
            id: vel_tr
            name: "Main"

            p:p
            f:f
            rn:rn
            a1:a1
            a2:a2
            a3:a3
            b1:b1
            b2:b2
            b3:b3

            d1:d1
            d2:d2
            d3:d3
            rh2t1:rh2t1
            rh2t2:rh2t2
            rh2t3:rh2t3
            n:n

            ScrollView:
                size: root.height, root.width
                size_hint: 1,1
                scroll_wheel_distance: '40dp'

        ####################  Overall Grid  ############################
                GridLayout:
                    rows: 15
                    size_hint_y:1.95
        ############ Overall Title ######################
                    GridLayout:
                        cols:2
                        size_hint_y: 0.08
                        BoxLayout:
                            size_hint_x:0.15
                            padding:dp(2)
                            orientation:'vertical'
                            MDIconButton:
                                id:info_button
                                theme_text_color:'Custom'
                                md_bg_color: [0,0,0,0]
                                text_color: [1,1,1,1]
                                user_font_size:dp(30)
                                icon:'menu'
                                allow_stretch: True
                                pos_hint: {'center_x':0.5}
                                on_release: nav_drawer.set_state('open')

                        BoxLayout:
                            size_hint_x: 0.85
                            canvas:
                                Color:
                                    rgba:0,0,0,0
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                                Color:
                                    rgba: 1,1,1,1
                                Line:
                                    width: dp(1)
                                    points: [self.x,self.y+dp(10),self.x,self.y+self.height-dp(10)]
                            Label:
                                text: '  VTA-APP'
                                color: [1,1,1,1]
                                font_name: 'BlackHanSans-Regular.ttf'
                                text_size: self.size
                                halign: 'left'
                                valign: 'middle'
                                font_size: dp(30)

                    BoxLayout:
                        size_hint_y:0.08
                        orientation: 'horizontal'
                        canvas:
                            Color:
                                rgba: 0.166,0.492,0.605,0.768
                            Rectangle:
                                pos: self.pos
                                size: self.size

                        MDLabel:
                            size_hint_x:1
                            text: "Velocity Triangles Analysis "
                            bold: True
                            font_size:dp(25)
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'

                    GridLayout:
                        cols: 4
                        size_hint_y: 0.06
                        canvas:
                            Color:
#                                rgba: 0.6862,0.9333,0.9333,0.6
                                rgba: 1,1,1,1
                            Rectangle:
                                pos: self.pos
                                size: self.size

                            Color:
                                rgba: 0,0,0,1
                            Line:
                                width: dp(1.5)
                                rectangle: (self.x,self.y,self.width,self.height)
                        Label:
                            size_hint_x: 0.7
                            text: 'Turbine'
                            bold: True if ch1.active else False
                            font_size: dp(20)

                        MDCheckbox:
                            id :ch1
                            group: 'tur_comp'
                            state: vel_tr.ch1_value
                            on_state: vel_tr.ch1_value = self.state

                        Label:
                            size_hint_x: 0.7
                            text: 'Compressor'
                            bold: True if ch2.active else False
                            font_size: dp(20)

                        MDCheckbox:
                            id :ch2
                            group: 'tur_comp'
                            state: vel_tr.ch2_value
                            on_state: vel_tr.ch2_value = self.state


                    BoxLayout:
                        padding: 10
                        size_hint_y: 0.08
                        canvas:
                            Color:
                                rgba: 0.333,0.596,0.635,0.9
                            Rectangle:
                                pos: self.pos
                                size: self.size

                        Label:
                            text:'Repeating Stage'
                            bold: False if switch0.active else True
                            #font_size: root.fontsize(self.text)
                            font_size: dp(15)
                            size: self.width,self.height
                            size_hint:0.4,1
                            halign: 'left'
                            valign: 'middle'

                        MDSwitch:
                            id: switch0

                        Label:
                            text:'   Non Repeating Stage'
                            bold: True if switch0.active else False
                            font_size: dp(15)
                            size_hint:0.45,1
                            halign: 'right'
                            valign: 'middle'

        ############ Keno anamesa sto switch kai ta inputs ###########################
                    BoxLayout:
                        size_hint_y: 0.01
                        canvas:
                            Color:
                                rgba:0.6862,0.9333,0.9333,0.737

                            Rectangle:
                                pos: self.pos
                                size: self.size

        ########### Grid for the Text Inputs #########################
                    GridLayout:
                        spacing: dp(3)
                        size_hint_y: 0.8
                        cols: 2
                        canvas:
                            Color:
                                rgba: 0.6862,0.9333,0.9333,0.737

                            Rectangle:
                                pos: self.pos
                                size: self.size

                        Label:
                            font_size:dp(14)
                            text:"Loading Coefficient \u03C8  [ - ]"
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'
                            size_hint_x: 1.5
                        Label:
                            font_size:dp(14)
                            text: "  "
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'
                        BoxLayout:
                            orientation: 'vertical'
                            TextInput:
                                id: p
                                text: '2' if slider1.value==0  else str(round(slider1.value,3))
                                size_hint_x: .7
                                pos_hint: {'center_x':.5}
                        MDSlider:
                            id: slider1
                            min: 0
                            max: 2.5
                            step: 0.01
                            value: 0


                        Label:
                            font_size:dp(14)
                            text:"Flow Coefficient \u03C6  [ - ] "
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'
                            size_hint_x: 1.5
                        Label:
                            font_size:dp(14)
                            text: "  "
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'
                        BoxLayout:
                            orientation: 'vertical'
                            TextInput:
                                id: f
                                text: '1' if slider2.value==0  else str(round(slider2.value,3))
                                size_hint_x: .7
                                pos_hint: {'center_x':.5}
                        MDSlider:
                            id: slider2
                            min: 0
                            max: 2
                            step: 0.01
                            value:0

                        Label:
                            font_size:vel_tr.l*dp(14)
                            text:"Reaction Coefficient Rn  [ - ] "
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'
                            size_hint_x: 1.5
                        Label:
                            font_size:dp(14)
                            text: "  "
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'
                        BoxLayout:
                            orientation: 'vertical'
                            TextInput:
                                id: rn
                                text: '0.5' if slider3.value==0  else str(round(slider3.value,3))
                                size_hint_x: .7
                                pos_hint: {'center_x':.5}
                        MDSlider:
                            id: slider3
                            min: 0
                            max: 1.5
                            step: 0.01
                            value: 0

                        Label:
                            font_size:dp(14)
                            text:"Inlet absolute angle \u03B11  [ \u00B0 ] "
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'
                            size_hint_x: 1.5
                        Label:
                            font_size:dp(14)
                            text: ""
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'
                        BoxLayout:
                            orientation: 'vertical'
                            TextInput:
                                id: a1
                                text: '' if slider4.value==0  else str(round(slider4.value,3))
                                size_hint_x: .7
                                pos_hint: {'center_x':.5}
                        MDSlider:
                            id: slider4
                            min: -75
                            max: 75
                            step: 0.1

                        Label:
                            font_size:dp(14)
                            text:"Exit absolute angle \u03B12   [ \u00B0 ] "
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'
                            size_hint_x: 1.5
                        Label:
                            font_size:dp(14)
                            text: " "
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'
                        BoxLayout:
                            orientation: 'vertical'
                            TextInput:
                                id: a2
                                text: '' if slider5.value==0  else str(round(slider5.value,3))
                                size_hint_x: .7
                                pos_hint: {'center_x':.5}
                        MDSlider:
                            id: slider5
                            min: -75
                            max: 75
                            step: 0.1

                        Label:
                            font_size:dp(14)
                            text:"Inlet absolute angle \u03B13  [ \u00B0 ] "
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'
                            size_hint_x: 1.5
                        Label:
                            font_size:dp(14)
                            text: " "
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'
                        BoxLayout:
                            orientation: 'vertical'
                            TextInput:
                                id: a3
                                text: '' if slider6.value==0  else str(round(slider6.value,3))
                                disabled: not switch0.active
                                size_hint_x: .7
                                pos_hint: {'center_x':.5}

                        MDSlider:
                            id: slider6
                            min: -75
                            max: 75
                            step: 0.1
                            disabled: not switch0.active

                        Label:
                            font_size:dp(14)
                            text:"Inlet relative angle \u03B21  [ \u00B0 ] "
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'
                            size_hint_x: 1.5
                        Label:
                            font_size:dp(14)
                            text: " "
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'
                        BoxLayout:
                            orientation: 'vertical'
                            TextInput:
                                id: b1
                                text: '' if slider7.value==0  else str(round(slider7.value,3))
                                size_hint_x: .7
                                pos_hint: {'center_x':.5}
                        MDSlider:
                            id: slider7
                            min: -75
                            max: 75
                            step: 0.1

                        Label:
                            font_size:dp(14)
                            text:"Exit relative angle \u03B22  [ \u00B0 ] "
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'
                            size_hint_x: 1.5
                        Label:
                            font_size:dp(14)
                            text: ""
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'
                        BoxLayout:
                            orientation: 'vertical'
                            TextInput:
                                id: b2
                                text: '' if slider8.value==0  else str(round(slider8.value,3))
                                size_hint_x: .7
                                pos_hint: {'center_x':.5}
                        MDSlider:
                            id: slider8
                            min: -75
                            max: 75
                            step: 0.1

                        Label:
                            font_size:dp(14)
                            text:"Inlet relative angle \u03B23  [ \u00B0 ] "
                            text_size: self.size
                            halign: 'center'
                            valign: 'middle'
                            size_hint_x: 1.5
                        Label:
                            font_size:dp(14)
                            text: " "
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'
                        BoxLayout:
                            orientation: 'vertical'
                            TextInput:
                                id: b3
                                text: '' if slider9.value==0  else str(round(slider9.value,3))
                                disabled: not switch0.active
                                size_hint_x: .7
                                pos_hint: {'center_x':.5}
                        MDSlider:
                            id: slider9
                            min: -75
                            max: 75
                            step: 0.1
                            disabled: not switch0.active

                    BoxLayout:
                        size_hint_y: 0.01
                        padding:dp(5)
                        canvas:
                            Color:
                                rgba: 0.6862,0.9333,0.9333,0.737
                            Rectangle:
                                pos: self.pos
                                size: self.size

        ############ Deyteros Titlos
                    BoxLayout:
                        size_hint_y: 0.08
                        padding:dp(5)
                        canvas:
                            Color:
                                rgba: 0.066,0.392,0.505,0.768
                            Rectangle:
                                pos: self.pos
                                size: self.size
                        Label:
                            text: " Dimensional Analysis "
                            bold: True
                            font_size:dp(25)

                    BoxLayout:
                        size_hint_y: 0.08
                        padding: dp(11)
                        canvas:
                            Color:
                                rgba: 0.333,0.596,0.635,0.9
                            Rectangle:
                                pos: self.pos
                                size: self.size

                        Label:
                            #font_size: root.fontsize(self.text)
                            font_size: dp(15)
                            bold: False if switch1.active else True
                            text:"Parallel Annulus"
                            size_hint_x: 0.45

                        MDSwitch:
                            id: switch1

                        Label:
                            #font_size: root.fontsize(self.text)
                            font_size: dp(15)
                            bold: True if switch1.active else False
                            text:"    Non Parallel Annulus"
                            size_hint_x: 0.45

                    BoxLayout:
                        size_hint_y: 0.01
                        padding:dp(5)
                        canvas:
                            Color:
                                rgba: 0.6862,0.9333,0.9333,0.737
                            Rectangle:
                                pos: self.pos
                                size: self.size

                    GridLayout:
                        spacing: dp(3)
                        size_hint_y: 0.31
                        cols: 3
                        canvas:
                            Color:
                                rgba: 0.6862,0.9333,0.9333,0.737

                            Rectangle:
                                pos: self.pos
                                size: self.size
                        Label:
                            font_size:dp(11)
                            text:"Tip Diameter at Stage 1: "
                            text_size: self.size
                            halign: 'right'
                            valign: 'middle'
                        TextInput:
                            multiline: False
                            id: d1
                            text:"2"
                        Label:
                            font_size:dp(11)
                            text: " [ m ]"
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'

                        Label:
                            font_size:dp(11)
                            text:"Tip Diameter at Stage 2: "
                            text_size: self.size
                            halign: 'right'
                            valign: 'middle'
                        TextInput:
                            disabled: not switch1.active
                            multiline: False
                            id: d2

                        Label:
                            font_size:dp(11)
                            text: " [ m ]"
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'

                        Label:
                            font_size:dp(11)
                            text:"Tip Diameter at Stage 3: "
                            text_size: self.size
                            halign: 'right'
                            valign: 'middle'
                        TextInput:
                            id: d3
                            disabled: not switch1.active
                            multiline: False

                        Label:
                            font_size:dp(11)
                            text: " [ m ]"
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'

                        Label:
                            font_size:dp(11)
                            text:" Hub2Tip ratio at Stage 1: "
                            text_size: self.size
                            halign: 'right'
                            valign: 'middle'
                        TextInput:
                            multiline: False
                            id: rh2t1
                            text:"0.8"
                        Label:
                            font_size:dp(11)
                            text: " [ - ]"
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'

                        Label:
                            font_size:dp(11)
                            text:" Hub2Tip ratio at Stage 2: "
                            text_size: self.size
                            halign: 'right'
                            valign: 'middle'
                        TextInput:
                            disabled: not switch1.active
                            multiline: False
                            id: rh2t2
                        Label:
                            font_size:dp(11)
                            text: " [ - ]"
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'

                        Label:
                            font_size:dp(11)
                            text:" Hub2Tip ratio at Stage 3: "
                            text_size: self.size
                            halign: 'right'
                            valign: 'middle'
                        TextInput:
                            disabled: not switch1.active
                            multiline: False
                            id: rh2t3
                        Label:
                            font_size:dp(11)
                            text: " [ - ]"
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'

                        Label:
                            font_size:dp(11)
                            text:" Rotational Speed : "
                            text_size: self.size
                            halign: 'right'
                            valign: 'middle'
                        TextInput:
                            multiline: False
                            id: n
                            text:"4000"
                        Label:
                            font_size:dp(11)
                            text: " [ rpm ]"
                            text_size: self.size
                            halign: 'left'
                            valign: 'middle'

                    BoxLayout:
                        size_hint_y: 0.01
                        padding:dp(5)
                        canvas:
                            Color:
                                rgba: 0.6862,0.9333,0.9333,0.737
                            Rectangle:
                                pos: self.pos
                                size: self.size

                    GridLayout:
                        cols: 2
                        size_hint_y: 0.2
                        canvas:
                            Color:
                                rgba: 0.6862,0.9333,0.9333,0.6
                            Rectangle:
                                pos: self.pos
                                size: self.size

                            Color:
                                rgba: 0,0,0,1
                            Line:
                                width: dp(1.5)
                                rectangle: (self.x,self.y,self.width,self.height)

                        Label:
                            size_hint_x: 0.8
                            text: 'Constant Angle Aproximation'
                            bold: True if ch3.active else False
                            font_size: dp(20)
                        MDCheckbox:
                            size_hint_x: 0.2
                            id :ch3
                            state: vel_tr.ch3_value
                            on_state: vel_tr.ch3_value = self.state
                        Label:
                            size_hint_x: 0.8
                            text: 'Free vortex design'
                            bold: True if ch4.active else False
                            font_size: dp(20)
                        MDCheckbox:
                            size_hint_x: 0.2
                            id :ch4
                            state: vel_tr.ch4_value
                            on_state: vel_tr.ch4_value = self.state
                        Label:
                            size_hint_x: 0.8
                            text: ' Forced vortex design'
                            bold: True if ch5.active else False
                            font_size: dp(20)
                        MDCheckbox:
                            size_hint_x: 0.2
                            id :ch5
                            state: vel_tr.ch5_value
                            on_state: vel_tr.ch5_value = self.state

                    BoxLayout:
                        size_hint_y: 0.08
                        padding: dp(10)
                        orientation:'vertical'
                        canvas:
                            Color:
                                rgba: 0.6862,0.9333,0.9333,0.737
                            Rectangle:
                                pos: self.pos
                                size: self.size

                        MDRoundFlatIconButton:
                            id:VA_button
                            icon:'airplane'
                            pos_hint:{'center_x':0.5}
                            size_hint_x: 0.42
                            text: "Velocity Analysis"
                            font_size:dp(14)
                            md_bg_color: [0.4,.4,.4,1]
                            text_color: [1,1,1,1]
                            on_release:
                                vel_tr.systemsolver()
                                vel_tr.dml()

                                if vel_tr.check == 0 :\
                                vel_tr.h2t_triangles();

                                if vel_tr.check == 0 and vel_tr.k == 4:\
                                win_manager.current = "hub_sc";

                                if vel_tr.check == 1 and vel_tr.k == 4:\
                                win_manager.current = "simple"
                                win_manager.transition.direction = 'left'

        NewWindow:
        SimWindow:
        MidScreen:
            id: mid
        HubScreen:
        TipScreen:
        CompScreen:
        InfoScreen:


    MDNavigationDrawer:
        id: nav_drawer
        md_bg_color: [1,1,1,1]
        swipe_edge_width: dp(10)
        width: dp(300)
        MDCard:
            orientation: 'vertical'
#            md_bg_color: [1,0,1,1]
            MDBoxLayout:
                md_bg_color: [0.2,0.2,.8,1]
                size_hint_y: 0.5
                FitImage:
                    source: 'images/logos/logo31.png'


            MDSeparator:
                height: dp(2)
                color: [0,0,0,1]
            BoxLayout:
                orientation: 'vertical'
                pos_hint: {'center_x':0.5}
                size_hint_y: 0.2

                MDRectangleFlatIconButton:
                    pos_hint: {'center_x':0.5}
                    icon:'home'
                    text:"Home"
                    on_release:
                        win_manager.current = "Main"
                        nav_drawer.set_state('close')


                MDRectangleFlatIconButton:
                    pos_hint: {'center_x':0.5}
                    icon:'information-outline'
                    text:"info"
                    on_press:
                        win_manager.current = "info"
                        nav_drawer.set_state('close')

                MDRectangleFlatIconButton:
                    pos_hint: {'center_x':0.5}
                    icon:'exit-to-app'
                    text:"Exit"
                    on_press:app.stop()

            MDGridLayout:
                rows: 2
                pos_hint: {'center_x':0.5}
                size_hint_y: 0.3
                md_bg_color: [.8,.8,.8,1]
                MDBoxLayout:
                    size_hint_y: 0.02
                    md_bg_color: [.8,.8,.8,1]
                MDBoxLayout:
                    md_bg_color: [.4,.4,.4,1]
                    orientation: 'vertical'
                    size_hint_y: 0.98
                    padding: dp(15)

                    MDBoxLayout:
                        cols: 2
                        orientation: 'horizontal'
                        padding: dp(2)
                        Image:
                            source: 'images/apth2.png'
                            size_hint_x: 0.2
                        Label:
                            size_hint_x: 0.8

                    MDLabel:
                        size_hint_y:0.6
                        text: 'Version: 1.0'
                        color: 1,1,1,1
                        font_size: dp(15)
                    MDLabel:
                        text: 'Aknowledgements: Dionisis Chala, Michail Tsinoglou'
                        color: 1,1,1,1
                        font_size: dp(15)
                    MDLabel:
                        text: '\u00A9 2020 Aristotle University of Thessaloniki. All rights reserved'
                        color: 1,1,1,1
                        font_size: dp(15)










